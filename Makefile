GO_EASY_ON_ME = 1
ARCHS = arm64e
THEOS_DEVICE_IP = localhost -p 2222
include ${THEOS}/makefiles/common.mk

ADDITIONAL_CFLAGS =  -fobjc-arc -Os -Qunused-arguments -Itemp -Wno-c++11-extensions -Xclang -fobjc-runtime-has-weak -Wno-deprecated-declarations -Wno-unsupported-availability-guard -Wno-strict-prototypes -Wno-unsupported-availability-guard

TARGET = iphone:clang:9.3

SHARED_CFLAGS = -fobjc-arc

TWEAK_NAME = FLEXInjected

# find ./FLEX -name \*.m -print | grep Classes | rev | cut -d"/" -f1 | rev | sed -e "s/^/temp\//" | tr "\\n" " "

$(TWEAK_NAME)_FILES = Tweak.xm temp/FLEXSingleRowSection.m temp/FLEXTableViewSection.m temp/FLEXTableViewController.m temp/FLEXNavigationController.m temp/FLEXFilteringTableViewController.m temp/FLEXKeyValueTableViewCell.m temp/FLEXCodeFontCell.m temp/FLEXSubtitleTableViewCell.m temp/FLEXMultilineTableViewCell.m temp/FLEXTableViewCell.m temp/FLEXScopeCarousel.m temp/FLEXCarouselCell.m temp/FLEXTableView.m temp/FLEXObjectExplorerFactory.m temp/FLEXDefaultsContentSection.m temp/FLEXMutableListSection.m temp/FLEXCollectionContentSection.m temp/FLEXColorPreviewSection.m temp/FLEXShortcutsSection.m temp/FLEXBlockShortcuts.m temp/FLEXClassShortcuts.m temp/FLEXImageShortcuts.m temp/FLEXViewShortcuts.m temp/FLEXBundleShortcuts.m temp/FLEXWindowShortcuts.m temp/FLEXNSStringShortcuts.m temp/FLEXLayerShortcuts.m temp/FLEXUIAppShortcuts.m temp/FLEXShortcutsFactory+Defaults.m temp/FLEXShortcut.m temp/FLEXViewControllerShortcuts.m temp/FLEXNSDataShortcuts.m temp/FLEXMetadataSection.m temp/FLEXObjectExplorerViewController.m temp/FLEXObjectExplorer.m temp/FLEXNetworkTransaction.m temp/FLEXNetworkSettingsController.m temp/FLEXNetworkRecorder.m temp/FLEXNetworkMITMViewController.m temp/FLEXNetworkTransactionCell.m temp/FLEXNetworkCurlLogger.m temp/FLEXHTTPTransactionDetailController.m temp/FLEXMITMDataSource.m temp/FLEXNetworkObserver.m temp/OSCache.m temp/FLEXExplorerToolbarItem.m temp/FLEXExplorerToolbar.m temp/FLEXManager+Extensibility.m temp/FLEXManager.m temp/FLEXManager+Networking.m temp/FLEXDefaultEditorViewController.m temp/FLEXMethodCallingViewController.m temp/FLEXFieldEditorViewController.m temp/FLEXVariableEditorViewController.m temp/FLEXArgumentInputStringView.m temp/FLEXArgumentInputColorView.m temp/FLEXArgumentInputView.m temp/FLEXArgumentInputSwitchView.m temp/FLEXArgumentInputStructView.m temp/FLEXArgumentInputDateView.m temp/FLEXArgumentInputObjectView.m temp/FLEXArgumentInputFontView.m temp/FLEXArgumentInputTextView.m temp/FLEXArgumentInputFontsPickerView.m temp/FLEXArgumentInputNumberView.m temp/FLEXArgumentInputNotSupportedView.m temp/FLEXArgumentInputViewFactory.m temp/FLEXFieldEditorView.m temp/FLEXTabsViewController.m temp/FLEXTabList.m temp/FLEXExplorerViewController.m temp/FLEXWindow.m temp/FLEXWindowManagerController.m temp/FLEXBookmarkManager.m temp/FLEXBookmarksViewController.m temp/FLEXViewControllersViewController.m temp/FLEXGlobalsEntry.m temp/FLEXGlobalsSection.m temp/FLEXGlobalsViewController.m temp/FLEXLiveObjectsController.m temp/FLEXObjectRef.m temp/FLEXWebViewController.m temp/FLEXObjectListViewController.m temp/FLEXKeychainViewController.m temp/FLEXKeychain.m temp/FLEXKeychainQuery.m temp/FLEXFileBrowserSearchOperation.m temp/FLEXFileBrowserController.m temp/FLEXActivityViewController.m temp/FLEXSystemLogCell.m temp/FLEXSystemLogViewController.m temp/FLEXSystemLogMessage.m temp/FLEXASLLogController.m temp/FLEXOSLogController.m temp/FLEXAddressExplorerCoordinator.m temp/FLEXTableLeftCell.m temp/FLEXSQLResult.m temp/FLEXTableContentViewController.m temp/FLEXTableListViewController.m temp/FLEXTableColumnHeader.m temp/FLEXMultiColumnTableView.m temp/FLEXRealmDatabaseManager.m temp/FLEXDBQueryRowCell.m temp/FLEXTableRowDataViewController.m temp/FLEXSQLiteDatabaseManager.m temp/FLEXCookiesViewController.m temp/FLEXRuntimeClient.m temp/FLEXRuntimeController.m temp/FLEXRuntimeExporter.m temp/FLEXRuntimeKeyPath.m temp/FLEXRuntimeBrowserToolbar.m temp/FLEXSearchToken.m temp/FLEXKBToolbarButton.m temp/FLEXKeyboardToolbar.m temp/FLEXObjcRuntimeViewController.m temp/FLEXRuntimeKeyPathTokenizer.m temp/FLEXKeyPathSearchController.m temp/FLEXAPNSViewController.m temp/FLEXImagePreviewViewController.m temp/FHSViewSnapshot.m temp/FHSRangeSlider.m temp/FHSView.m temp/FHSViewController.m temp/SceneKit+Snapshot.m temp/FHSSnapshotNodes.m temp/FHSSnapshotView.m temp/FLEXHierarchyTableViewCell.m temp/FLEXHierarchyTableViewController.m temp/FLEXHierarchyViewController.m temp/FLEXUtility.m temp/FLEXHeapEnumerator.m temp/FLEXRuntimeUtility.m temp/FLEXRuntimeSafety.m temp/FLEXRuntimeConstants.m temp/FLEXTypeEncodingParser.m temp/FLEXMirror.m temp/FLEXPropertyAttributes.m temp/FLEXProperty.m temp/FLEXMetadataExtras.m temp/FLEXMethod.m temp/FLEXIvar.m temp/FLEXProtocolBuilder.m temp/FLEXBlockDescription.m temp/FLEXClassBuilder.m temp/FLEXProtocol.m temp/FLEXMethodBase.m temp/FLEXAlert.m temp/FLEXResources.m temp/FLEXColor.m temp/UIGestureRecognizer+Blocks.m temp/FLEXRuntime+Compare.m temp/NSArray+FLEX.m temp/NSObject+FLEX_Reflection.m temp/NSDateFormatter+FLEX.m temp/FLEXRuntime+UIKitHelpers.m temp/NSTimer+FLEX.m temp/UIMenu+FLEX.m temp/UIPasteboard+FLEX.m temp/NSUserDefaults+FLEX.m temp/UITextField+Range.m temp/UIView+FLEX_Layout.m temp/NSMapTable+FLEX_Subscripting.m temp/NSString+ObjcRuntime.m temp/Cocoa+FLEXShortcuts.m temp/NSString+FLEX.m temp/NSDictionary+ObjcRuntime.m temp/UIBarButtonItem+FLEX.m temp/CALayer+FLEX.m temp/UIFont+FLEX.m temp/FLEXKeyboardShortcutManager.m temp/FLEXKeyboardHelpViewController.m temp/flex_fishhook.c temp/FLEXSwiftInternal.mm temp/FLEXObjcInternal.mm temp/FLEXObjcInternal.mm temp/FLEXFirebaseTransaction.mm
$(TWEAK_NAME)_FRAMEWORKS = UIKit CoreGraphics QuartzCore ImageIO
$(TWEAK_NAME)_LDFLAGS = -lz -lsqlite3
$(TWEAK_NAME)_CCFLAGS = -std=gnu++11
BUNDLE_NAME = FLEXInjectedBundle
FLEXInjectedBundle_INSTALL_PATH = /Library/MobileSubstrate/DynamicLibraries
include $(THEOS)/makefiles/bundle.mk

include $(THEOS_MAKE_PATH)/tweak.mk

after-install::
	install.exec "killall -9 SpringBoard"


